syntax = "proto3";

package tk.api;

import "common/common.proto";
import "db/db.proto";

message UploadStudentCsvRequest {
  bytes csv_data = 1;
}
message UploadStudentCsvResponse {}

message UploadMentorCsvRequest {
  bytes csv_data = 1;
}
message UploadMentorCsvResponse {}

message TeamMemberResponse {
  string id = 1;
  db.TeamMember team_member = 2;
}

message GetTeamMembersRequest {}
message GetTeamMembersResponse {
  repeated TeamMemberResponse team_members = 1;
}

message GetStudentsRequest {}
message GetStudentsResponse {
  repeated TeamMemberResponse students = 1;
}

message GetMentorsRequest {}
message GetMentorsResponse {
  repeated TeamMemberResponse mentors = 1;
}

message StreamTeamMembersRequest {}
message StreamTeamMembersResponse {
  repeated TeamMemberResponse team_members = 1;
  common.SyncType sync_type = 2;
}

message StreamStudentsRequest {}
message StreamStudentsResponse {
  repeated TeamMemberResponse students = 1;
  common.SyncType sync_type = 2;
}

message StreamMentorsRequest {}
message StreamMentorsResponse {
  repeated TeamMemberResponse mentors = 1;
  common.SyncType sync_type = 2;
}

message CreateTeamMemberRequest {
  string first_name = 1;
  string last_name = 2;
  db.TeamMemberType member_type = 3;
  optional string display_name = 4;
  optional string discord_username = 5;
}
message CreateTeamMemberResponse {}

message UpdateTeamMemberRequest {
  string id = 1;
  string first_name = 2;
  string last_name = 3;
  db.TeamMemberType member_type = 4;
  optional string display_name = 5;
  optional string discord_username = 6;
}
message UpdateTeamMemberResponse {}

message DeleteTeamMemberRequest {
  string id = 1;
}
message DeleteTeamMemberResponse {}

service TeamMemberService {
  rpc UploadStudentCsv(UploadStudentCsvRequest) returns (UploadStudentCsvResponse);
  rpc UploadMentorCsv(UploadMentorCsvRequest) returns (UploadMentorCsvResponse);

  rpc GetTeamMembers(GetTeamMembersRequest) returns (GetTeamMembersResponse);
  rpc GetStudents(GetStudentsRequest) returns (GetStudentsResponse);
  rpc GetMentors(GetMentorsRequest) returns (GetMentorsResponse);

  rpc StreamTeamMembers(StreamTeamMembersRequest) returns (stream StreamTeamMembersResponse);
  rpc StreamStudents(StreamStudentsRequest) returns (stream StreamStudentsResponse);
  rpc StreamMentors(StreamMentorsRequest) returns (stream StreamMentorsResponse);

  rpc CreateTeamMember(CreateTeamMemberRequest) returns (CreateTeamMemberResponse);
  rpc UpdateTeamMember(UpdateTeamMemberRequest) returns (UpdateTeamMemberResponse);
  rpc DeleteTeamMember(DeleteTeamMemberRequest) returns (DeleteTeamMemberResponse);
}
